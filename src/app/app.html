<div class="right-side">

  <div class="controls" style="margin-bottom:1rem;">
    <button (click)="fetchUsuarios()" [disabled]="cargando()">
      {{ cargando() ? 'Cargando...' : 'Cargar usuarios' }}
    </button>

    <button (click)="clearUsuarios()" style="margin-left:.5rem;">
      Limpiar
    </button>
  </div>

  @if (usuarios() === null) {
    <p>Presiona <strong>Cargar usuarios</strong> para obtener datos desde el backend.</p>
  } @else {

    @if (usuarios()!.length === 0) {
      <p>No hay usuarios registrados.</p>
    } @else {

      <ul class="usuarios-list">
        @for (u of usuarios()!; track u.id) {
          <li class="usuario">
            <h3>{{ u.nombre }} <small>({{ u.rol }})</small></h3>
            <p>ID: {{ u.id }}</p>

            @if (u.libros?.length) {
              <h4>Libros:</h4>
              <ul>
                @for (l of u.libros; track $index) {
                  <li>
                    <strong>{{ l.titulo }}</strong> â€” {{ l.autor }}
                    <span style="opacity:.7">({{ l.estadoLibro }})</span>
                  </li>
                }
              </ul>
            } @else {
              <p>Sin libros.</p>
            }

          </li>
        }
      </ul>

    }
  }
</div>
